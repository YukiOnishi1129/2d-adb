# 2D-ADB (二次元コンテンツデータベース)

ASMR・同人音声・同人ゲームの検索サイト。DLsite/FANZAの作品をAIで分析し、声優・サークル・シチュエーションで検索可能。

**URL**: https://2d-adb.com

## 技術スタック

| レイヤー | 技術 |
|---------|------|
| フロントエンド | Next.js 15 (App Router), React 19, TypeScript |
| スタイリング | Tailwind CSS 4, shadcn/ui |
| データベース | PostgreSQL (Neon) |
| ホスティング | シン・レンタルサーバー |
| 画像CDN | Cloudflare Images |
| ビルド | GitHub Actions |

## アーキテクチャ概要

```
┌─────────────────┐     ┌──────────────────┐
│  DLsite API     │────▶│                  │
└─────────────────┘     │   PostgreSQL     │
                        │   (Neon)         │
┌─────────────────┐     │                  │
│  FANZA API      │────▶│  - works         │
└─────────────────┘     │  - circles       │
                        │  - cvs           │
┌─────────────────┐     │  - tags          │
│  OpenAI API     │────▶│  - sale_features │
│  (AI分析)       │     │  - daily_recs    │
└─────────────────┘     └────────┬─────────┘
                                 │
                                 ▼
                        ┌──────────────────┐
                        │  Next.js (SSG)   │
                        │  GitHub Actions  │
                        │  で毎日ビルド     │
                        └────────┬─────────┘
                                 │
                                 ▼
                        ┌──────────────────┐
                        │ シン・レンタル    │
                        │ サーバー (静的)   │
                        └──────────────────┘
```

## 自動化の仕組み

### 1. データ収集 (バックエンド - 別リポジトリ)
- **DLsite/FANZAスクレイピング**: 定期実行で新作・セール情報を取得
- **AI分析**: OpenAI APIで作品の要約・おすすめ理由・タグを自動生成
- **画像処理**: サムネイルをCloudflare Imagesにアップロード
- **セール特集生成**: AIが毎日のセール特集コンテンツを自動生成
- **おすすめ生成**: AIが毎日のおすすめ作品を自動選定

### 2. サイトビルド (GitHub Actions)
- **毎日自動ビルド**: 新しいデータを反映した静的サイトを生成
- **トリガー**: スケジュール実行 + 手動トリガー対応
- **デプロイ**: ビルド成功後、自動でシン・レンタルサーバーへデプロイ

### 3. RSS/サイトマップ生成
- **feed.xml**: 新着20件のRSSフィード
- **sitemap.xml**: 全ページの動的サイトマップ
- ビルド時に自動生成

## マネタイズ戦略

### アフィリエイト構造
```
ユーザー → 2D-ADB作品ページ → DLsite/FANZAアフィリエイトリンク → 購入 → 報酬
```

### 収益源
1. **DLsiteアフィリエイト**: 作品購入の10%
2. **FANZAアフィリエイト**: 作品購入の15-25%

### リンク配置
- 作品詳細ページ: 「DLsiteで購入」「FANZAで購入」ボタン + スマホ固定CTA
- 一覧ページ: 各カードにリンク内蔵
- セール特集ページ: セール中作品への誘導

## X (Twitter) 集客戦略

### 自動投稿システム
- **毎日おすすめ作品投稿**: AIが選んだおすすめ作品を自動ツイート
- **セール情報投稿**: セール開始時に自動告知
- **新着作品投稿**: 注目の新作を自動紹介

### 投稿内容
- 作品タイトル + AIによるおすすめ理由
- サムネイル画像
- サイトへのリンク（`?theme=dark`付きでダークモード表示）

### アカウント
- X経由の流入はダークモードで表示（深夜ユーザー対策）

## SEO施策

### 実装済み
- **構造化データ (JSON-LD)**: Product, BreadcrumbList
- **動的メタデータ**: 各ページに適切なtitle/description
- **サイトマップ**: 全作品・声優・タグページを網羅
- **RSS**: Google Discover対応
- **内部リンク**: 関連作品・同一声優作品への相互リンク
- **関連作品レコメンド**: 作品詳細ページ下部に「こちらもおすすめ」4件表示

### 計画中
- **まとめ記事**: シチュエーション別・声優別のキュレーション記事
- **Bing Webmaster Tools**: 登録

## 主要ページ

| ページ | パス | 説明 |
|--------|------|------|
| トップ | `/` | 新着・セール・ランキング・人気声優/タグ表示 |
| 作品詳細 | `/works/[id]` | 個別作品ページ（関連作品レコメンド付き） |
| 作品一覧 | `/works` | 全作品リスト |
| 検索 | `/search` | キーワード検索（クライアントサイド） |
| 声優一覧 | `/cv` | 全声優リスト |
| 声優別 | `/cv/[name]` | 声優別作品一覧 |
| サークル一覧 | `/circles` | 全サークルリスト |
| サークル別 | `/circles/[name]` | サークル別作品一覧 |
| タグ一覧 | `/tags` | 全タグリスト |
| タグ別 | `/tags/[name]` | タグ別作品一覧 |
| セール | `/sale` | セール中作品（フィルター・ソート対応） |
| セール特集 | `/sale/tokushu` | AIが選ぶ今日のセール特集 |
| おすすめ | `/recommendations` | AI推薦作品 |
| プライバシー | `/privacy` | プライバシーポリシー |

## 主要コンポーネント

| コンポーネント | 説明 |
|---------------|------|
| `WorkCard` | 作品カード（サムネ・価格・セール情報・評価） |
| `Header` | ヘッダー（ロゴ・検索・ナビ） |
| `Footer` | フッター（リンク・RSS・クレジット） |
| `MobileNav` | スマホ固定ナビゲーション |
| `FixedPurchaseCta` | スマホ固定購入ボタン |
| `SampleImageGallery` | サンプル画像ギャラリー（モーダル対応） |
| `FeaturedBanners` | セール・おすすめバナー |
| `SaleTimer` | セール残り時間カウントダウン |
| `ThemeQueryProvider` | `?theme=dark`でダークモード切替 |
| `AgeGate` | 年齢確認モーダル |
| `SearchBox` | クライアントサイド検索（Fuse.js） |

## テーマ

- **デフォルト**: ライトモード
- **ダークモード**: `.dark`クラス or `?theme=dark`クエリパラメータ
- X経由の流入は自動でダークモード

## トップページ構成

| 順序 | セクション | 説明 |
|------|-----------|------|
| 1 | セール中 | 割引率の高い順に表示 |
| 2 | ボイス・ASMRランキング | 音声作品をランキング順 |
| 3 | ゲームランキング | ゲーム作品をランキング順 |
| 4 | 高評価作品 | 4.5以上の作品 |
| 5 | 爆安コーナー | 500円以下の作品 |
| 6 | 新着作品 | 発売日が新しい順 |
| 7 | 人気声優 | 出演作品数の多い声優バッジ |
| 8 | 人気タグ | 作品数の多いタグバッジ |

## 作品詳細ページ

### IDの形式
- **数値ID**: DBのプライマリキー (例: `/works/101`)
- **RJコード**: DLsiteの作品コード (例: `/works/RJ01525290`)

両方に対応。外部リンク（SNSシェア等）からもアクセス可能。

### レイアウト
- ヒーロー画像（サムネイル）
- 作品情報（タイトル、サークル、声優、タグ）
- AIレビュー・おすすめ理由
- 価格比較テーブル（DLsite/FANZA）
- サンプル画像ギャラリー
- スペック表（再生時間、CG枚数等）
- **こちらもおすすめ**（関連作品4件）
- スマホ固定購入ボタン

## モバイル対応

### レイアウト階層（z-index）
```
z-50: モバイルナビゲーション (bottom-0, h-14)
z-40: 固定購入CTA (bottom-14)
```

ページ下部には `pb-32` のパディングでコンテンツが隠れないようにする。

### モバイルナビ
画面下部に固定表示（768px未満）:
- ホーム、検索、セール、作品、声優

## 検索システム

### 検索インデックス
ビルド時に `public/data/search-index.json` を生成。Fuse.jsでクライアントサイド全文検索。

### フィルタ
- カテゴリ（ASMR/ゲーム）
- プラットフォーム（DLsite/FANZA）
- セール中のみ
- 価格帯

### ソート
- ランキング順、新着順、価格順、割引率順

## 環境変数

```
DATABASE_URL=postgresql://...  # Neon PostgreSQL接続文字列
```

## ローカル開発

```bash
cd frontend/black/2d-adb
npm install
npm run dev
```

## ビルド

```bash
npm run build  # search-index, sitemap, feed生成 → Next.jsビルド
npm run serve  # ローカルでビルド結果を確認
```

## 関連ドキュメント

- [進捗レポート](./reports/) - 日付別の状況報告
